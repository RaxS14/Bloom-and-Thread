<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard — Bloom & Thread</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Great+Vibes&display=swap" rel="stylesheet">

<style>
body {
  font-family: 'Poppins', sans-serif;
  margin:0;
  display:flex;
  background: #f7f2f5;
  color: #4b3b4c;
  height:100vh;
  overflow:hidden;
}

/* Sidebar */
.sidebar {
  width: 240px;
  background: #fff0f5;
  padding: 2rem 1rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  border-right: 1px solid #e0cbbf;
  box-shadow: 2px 0 15px rgba(0,0,0,0.05);
  position: fixed;
  height: 100%;
}

.sidebar img {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  object-fit: cover;
}

.sidebar h2 {
  margin-top: 0.5rem;
  font-size: 1.3rem;
  color: #b85c8a;
}

.sidebar p {
  font-size: 0.9rem;
  color: #9e718a;
  margin-bottom: 2rem;
}

.sidebar ul {
  list-style: none;
  width: 100%;
  padding: 0;
}

.sidebar ul li {
  margin: 0.5rem 0;
}

.sidebar ul li a {
  text-decoration: none;
  display: flex;
  align-items: center;
  padding: 0.7rem 1rem;
  border-radius: 10px;
  color: #4b3b4c;
  transition: all 0.3s;
}

.sidebar ul li a:hover,
.sidebar ul li a.active {
  background: #ffd6e7;
  color: #b85c8a;
  font-weight: 600;
}

.sidebar ul li a i {
  margin-right: 10px;
}

/* Main + Footer wrapper */
.content-wrapper {
  margin-left: 240px;
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 100vh;
}

/* Main content */
main {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
}

/* Header */
header {
  background: linear-gradient(135deg, #ffb6c1, #ffdee9);
  padding: 20px;
  font-size: 1.5rem;
  font-weight: 600;
  color: #4b3b4c;
  border-radius: 12px;
  margin-bottom: 20px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.1);
}

/* Tables */
.table-container {
  margin-bottom: 30px;
  overflow-x: auto;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: white;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 15px rgba(0,0,0,0.05);
}

th, td {
  padding: 12px 15px;
  text-align: center;
  border-bottom: 1px solid #eee;
}

th { background: #ffdee9; font-weight:600; }

td button {
  padding: 6px 12px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  font-weight: 600;
  margin: 2px;
}

.remove-btn { background: #ff6b81; color: white; }
.remove-btn:hover { background: #e04e63; }

.status-select {
  padding: 5px 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-weight: 600;
  cursor: pointer;
}

/* Modal */
.modal {
  display: none;
  position: fixed;
  top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,0.7);
  justify-content:center;
  align-items:center;
  z-index: 999;
}

.modal-content {
  background: white;
  padding: 20px;
  border-radius: 12px;
  max-width: 600px;
  width: 90%;
  max-height: 80vh;
  overflow-y: auto;
  text-align:center;
}

.modal-content img { max-width: 100%; border-radius: 12px; margin-top: 15px; }

.modal-close {
  position:absolute;
  top:15px; right:20px;
  font-size:1.5rem;
  color:white;
  cursor:pointer;
}

/* Footer */
footer {
  text-align:center;
  padding:10px 0;
  font-size:0.9rem;
  color:#999;
}

/* Responsive */
@media(max-width:768px){
  body { flex-direction: column; }
  .sidebar { width: 100%; flex-direction: row; justify-content: space-around; padding: 1rem; }
  .content-wrapper { margin-left:0; }
}
</style>
</head>
<body>

<aside class="sidebar">
  <img src="images/admin-avatar.png" alt="Admin Avatar">
  <h2>Admin</h2>
  <p>Administrator</p>
  <ul>
    <li><a href="#" class="active"><i class="ri-dashboard-line"></i> Dashboard</a></li>
    <li><a href="adminorder.html"><i class="ri-shopping-bag-3-line"></i> Orders</a></li>
    <li><a href="inventory.html"><i class="ri-archive-2-line"></i> Inventory</a></li>
    <li><a href="supplier.html"><i class="ri-truck-line"></i> Suppliers</a></li>
    <li><a href="reports.html"><i class="ri-bar-chart-2-line"></i> Reports</a></li>
    <li><a href="#" id="logoutLink"><i class="ri-logout-circle-line"></i> Logout</a></li>
  </ul>
</aside>

<div class="content-wrapper">
  <main>
    <header>Bloom & Thread — Admin Dashboard</header>

    <div class="table-container">
      <h2 style="text-align:center; margin-bottom:10px;">Customer Requests / Refunds</h2>
      <table id="requestsTable">
        <thead>
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>Email</th>
            <th>Reason</th>
            <th>Message</th>
            <th>Images</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </main>

  <footer>&copy; 2025 Bloom & Thread. All rights reserved.</footer>
</div>

<!-- Image Modal -->
<div id="imageModal" class="modal">
  <span class="modal-close" onclick="closeImageModal()">&times;</span>
  <div class="modal-content">
    <img id="modalImage" src="" alt="Preview">
  </div>
</div>

<script>
// Logout
document.getElementById('logoutLink').addEventListener('click', e=>{
  e.preventDefault();
  localStorage.clear();
  window.location.href='login.html';
});

// Requests
const requestsTableBody = document.querySelector('#requestsTable tbody');
function loadRequests(){
  const requests = JSON.parse(localStorage.getItem('bloom_contact_requests'))||[];
  requestsTableBody.innerHTML='';
  if(!requests.length){ requestsTableBody.innerHTML='<tr><td colspan="8">No requests found.</td></tr>'; return; }
  requests.forEach((req,i)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`
      <td>${i+1}</td>
      <td>${req.name}</td>
      <td>${req.email}</td>
      <td>${req.reason}</td>
      <td>${req.message}</td>
      <td>${(req.images||[]).map(img=>`<img src="${img}" width="50" style="cursor:pointer;" onclick="showImageModal('${img}')">`).join('')}</td>
      <td>
        <select class="status-select" onchange="updateRequestStatus(${i},this.value)">
          <option value="Pending" ${req.status==='Pending'?'selected':''}>Pending</option>
          <option value="In Progress" ${req.status==='In Progress'?'selected':''}>In Progress</option>
          <option value="Resolved" ${req.status==='Resolved'?'selected':''}>Resolved</option>
        </select>
      </td>
      <td><button class="remove-btn" onclick="removeRequest(${i})">Remove</button></td>
    `;
    requestsTableBody.appendChild(tr);
  });
}

function updateRequestStatus(index,status){
  const requests=JSON.parse(localStorage.getItem('bloom_contact_requests'))||[];
  if(!requests[index]) return;
  requests[index].status=status;
  localStorage.setItem('bloom_contact_requests',JSON.stringify(requests));
  loadRequests();
}

function removeRequest(index){
  const requests=JSON.parse(localStorage.getItem('bloom_contact_requests'))||[];
  if(!requests[index]) return;
  if(confirm('Remove this request?')){
    requests.splice(index,1);
    localStorage.setItem('bloom_contact_requests',JSON.stringify(requests));
    loadRequests();
  }
}

// Image modal
function showImageModal(src){
  document.getElementById('modalImage').src=src;
  document.getElementById('imageModal').style.display='flex';
}
function closeImageModal(){ document.getElementById('imageModal').style.display='none'; }

window.addEventListener("storage", e=>{
  if(e.key==="bloom_contact_requests") loadRequests();
});

// Init
loadRequests();
</script>
</body>
</html>
