<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bloom & Thread - Collection</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --primary-color: #5e366e;
  --secondary-color: #ffb6c1;
  --text-color: #4a2c2a;
  --bg-color: rgba(255, 240, 245, 0.8);
  --shadow-color: rgba(255, 182, 193, 0.4);
  --footer-bg: rgba(94, 54, 110, 0.9);
}
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Poppins',sans-serif; color:var(--text-color); min-height:100vh; display:flex; flex-direction:column; text-align:center; position:relative; }
.background-overlay { background:url('thread.png') no-repeat center center fixed; background-size:cover; filter:blur(1px) brightness(1); position:absolute; top:0; left:0; width:100%; height:100%; z-index:-1; }
.navbar { width:100%; background:var(--footer-bg); position:sticky; top:0; z-index:1000; }
.nav-container { max-width:1700px; margin:0 auto; padding:20px 30px; display:flex; justify-content:space-between; align-items:center; }
.logo { font-family:'Great Vibes', cursive; color:#fff; font-size:1.8rem; text-decoration:none; }
.nav-links { list-style:none; display:flex; gap:25px; }
.nav-links li a { color:#fff; text-decoration:none; font-weight:500; transition:color 0.3s; }
.nav-links li a:hover, .nav-links li a.active { color:var(--secondary-color); }
header { margin-top:100px; }
header h1 { font-family:'Great Vibes', cursive; font-size:3.5rem; color:var(--primary-color); margin-bottom:10px; }
header .tagline { font-size:1.2rem; font-weight:700; color:var(--primary-color); }
.collection-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:30px; max-width:1200px; margin:60px auto; padding:0 20px; }
.collection-item { background:var(--bg-color); padding:15px; border-radius:20px; box-shadow:0 4px 20px var(--shadow-color); text-align:center; transition: transform 0.3s, box-shadow 0.3s; display:flex; flex-direction:column; justify-content:space-between; }
.collection-item img { width:100%; border-radius:15px; margin-bottom:10px; }
.collection-item h3 { color:var(--text-color); font-weight:600; font-size:1.1rem; margin-bottom:5px; }
.collection-item .price { font-weight:700; color:var(--primary-color); margin-bottom:10px; }
.collection-item:hover { transform:translateY(-5px); box-shadow:0 8px 25px rgba(255,182,193,0.5); }
.item-controls { display:flex; justify-content:center; align-items:center; gap:10px; flex-wrap:wrap; margin-top:10px; }
.item-controls button { background:var(--primary-color); color:#fff; border:none; padding:6px 12px; border-radius:8px; font-size:0.9rem; cursor:pointer; transition:background 0.3s,color 0.3s; }
.item-controls button:hover { background:var(--secondary-color); color:var(--text-color); }
.item-controls .quantity { font-weight:600; font-size:1rem; min-width:25px; display:inline-block; text-align:center; }
.item-controls .add-to-cart[disabled] { background:#aaa; cursor:not-allowed; color:#555; }
footer { background:var(--footer-bg); color:#fff; padding:20px 0; text-align:center; font-size:0.95rem; margin-top:auto; }
@media (max-width:768px) { .collection-grid { gap:20px; } .item-controls { gap:5px; } }
</style>
</head>
<body>

<div class="background-overlay"></div>

<nav class="navbar">
  <div class="nav-container">
    <a href="index.html" class="logo">Bloom & Thread</a>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="collection.html" class="active">Collection</a></li>
      <li><a href="cart.html">Cart</a></li>
      <li><a href="order.html">Order</a></li>
      <li><a href="reviews.html">Reviews</a></li>
      <li><a href="contactus.html">Contact Us</a></li>
      <li><a href="policies.html">Policies</a></li>
      <li><a href="logout.html">Logout</a></li>
    </ul>
  </div>
</nav>

<header>
  <h1>Our Collection</h1>
  <p class="tagline">Handmade with love and creativity</p>
</header>

<main>
  <section class="collection-grid" id="collection-grid"></section>
</main>

<footer>
  <p>&copy; 2025 Bloom & Thread. All rights reserved.</p>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const COLLECTION_KEY = 'bloom_inventory';
  let cart = JSON.parse(localStorage.getItem('cart')) || [];
  const collectionGrid = document.getElementById('collection-grid');

  // Default inventory
  const DEFAULT_INVENTORY = [
    { title:"Crochet Sunflower Hair Clips (Set of 2)", stock:20, pending:0, rejected:0, img:"images/crochet_sunflower_hair_clips.jpg", price:134 },
    { title:"Handmade Crochet Tote Bag with flowers", stock:20, pending:0, rejected:0, img:"images/handmade_crochet_tote_bag.jpg", price:280 },
    { title:"Crochet Tulip in Handmade Pot", stock:20, pending:0, rejected:0, img:"images/crochet_tulip_handmade_pot.jpg", price:70 },
    { title:"Crochet Red & White Hair Clip Collection (12 pcs)", stock:20, pending:0, rejected:0, img:"images/crochet_red_white_hair_clips.jpg", price:100 },
    { title:"Crochet Heart Hair Clips (Set of 6)", stock:20, pending:0, rejected:0, img:"images/crochet_heart_hair_clips.jpg", price:30 },
    { title:"Green Crochet Top", stock:20, pending:0, rejected:0, img:"images/green_crochet_top.jpg", price:250 },
    { title:"White Crochet Top", stock:20, pending:0, rejected:0, img:"images/white_crochet_top.jpg", price:210 },
    { title:"Mini Crochet Jacket", stock:20, pending:0, rejected:0, img:"images/mini_crochet_jacket.jpg", price:205 },
    { title:"Sexy Pink Crochet Top", stock:20, pending:0, rejected:0, img:"images/sexy_pink_crochet_top.jpg", price:265 },
    { title:"Square Crochet Top", stock:20, pending:0, rejected:0, img:"images/square_crochet_top.jpg", price:135 },
    { title:"Sexy Green Crochet Top", stock:20, pending:0, rejected:0, img:"images/sexy_green_crochet_top.jpg", price:950 },
    { title:"Brown Crochet Top", stock:20, pending:0, rejected:0, img:"images/brown_crochet_top.jpg", price:255 },
    { title:"Bunny Crochet Fan Cover", stock:20, pending:0, rejected:0, img:"images/bunny_crochet_fan_cover.jpg", price:169 },
    { title:"Crochet Water Bottle Bag with Purple Flower & White Accents", stock:20, pending:0, rejected:0, img:"images/crochet_water_bottle_bag.jpg", price:190 }
  ];

  // Load inventory, ensure price exists
  let inventory = JSON.parse(localStorage.getItem(COLLECTION_KEY));
  if(!inventory) {
    inventory = DEFAULT_INVENTORY;
  } else {
    // Fix missing price in existing inventory
    inventory.forEach((item, idx) => {
      if(item.price === undefined) item.price = DEFAULT_INVENTORY[idx]?.price || 0;
      if(item.stock === undefined) item.stock = 0;
      if(item.pending === undefined) item.pending = 0;
      if(item.rejected === undefined) item.rejected = 0;
    });
  }
  localStorage.setItem(COLLECTION_KEY, JSON.stringify(inventory));

  function renderProducts() {
    collectionGrid.innerHTML = '';
    inventory.forEach(product => {
      const item = document.createElement('div');
      item.className = 'collection-item';
      item.innerHTML = `
        <img src="${product.img}" alt="${product.title}">
        <h3>${product.title}</h3>
        <p class="price">â‚±${Number(product.price).toLocaleString()}</p>
        <p class="status">Stock: ${product.stock} | Pending: ${product.pending} | Rejected: ${product.rejected}</p>
        <div class="item-controls">
          <button class="decrease">-</button>
          <span class="quantity">1</span>
          <button class="increase">+</button>
          <button class="add-to-cart"${product.stock <= 0 ? ' disabled' : ''}>${product.stock <= 0 ? 'Out of Stock' : 'Add to Cart'}</button>
        </div>
      `;
      collectionGrid.appendChild(item);

      const quantitySpan = item.querySelector('.quantity');
      const decreaseBtn = item.querySelector('.decrease');
      const increaseBtn = item.querySelector('.increase');
      const addBtn = item.querySelector('.add-to-cart');

      decreaseBtn.addEventListener('click', () => {
        let qty = parseInt(quantitySpan.innerText);
        if(qty > 1) quantitySpan.innerText = qty - 1;
      });

      increaseBtn.addEventListener('click', () => {
        let qty = parseInt(quantitySpan.innerText);
        if(qty < product.stock) quantitySpan.innerText = qty + 1;
      });

      addBtn.addEventListener('click', () => {
        const qty = parseInt(quantitySpan.innerText);
        if(qty > product.stock) return alert(`Only ${product.stock} left in stock!`);

        const existing = cart.find(i => i.title === product.title);
        if(existing) existing.quantity += qty;
        else cart.push({ title: product.title, price: product.price, imgSrc: product.img, quantity: qty });

        // Update inventory stock & pending
        const idx = inventory.findIndex(p => p.title === product.title);
        inventory[idx].stock -= qty;
        inventory[idx].pending += qty;

        localStorage.setItem(COLLECTION_KEY, JSON.stringify(inventory));
        localStorage.setItem('cart', JSON.stringify(cart));

        quantitySpan.innerText = 1;
        renderProducts();
      });
    });
  }

  renderProducts();
  window.addEventListener('storage', () => {
    inventory = JSON.parse(localStorage.getItem(COLLECTION_KEY));
    renderProducts();
  });
});
</script>

</body>
</html>
